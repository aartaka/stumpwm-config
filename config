(in-package :stumpwm-user)

;; Just in case Quicklisp won't be found. Gotta also make this install QL in case it needs to.
#-quicklisp
(let ((quicklisp-init
       (merge-pathnames "quicklisp/setup.lisp" (user-homedir-pathname))))
  (when (probe-file quicklisp-init)
    (load quicklisp-init)))

(defun home (path)
  "Resolve the PATH against $HOME.
Not really useful, but saves some typing and makes all the HOME
resolution consistent."
  (namestring (uiop:merge-pathnames*
               (string-left-trim "/" path) (user-homedir-pathname))))

(defun config (path)
  "Resolve the PATH against StumpWM config dir.
Useful for dependency-based config files."
  (namestring (uiop:merge-pathnames*
               (string-left-trim "/" path) (home ".config/stumpwm/"))))

(asdf:load-asd (config "deps/line-readtable/line-readtable.asd"))

;; Important asdf-loads
(asdf:load-systems :cl-ppcre :zpng :trivial-clipboard :bordeaux-threads :line-readtable)

(load (config "config.lisp"))
